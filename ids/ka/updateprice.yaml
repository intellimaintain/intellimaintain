parent: 'katype:adjustDatabaseSql'
name: Update Price
required:
  - itemId
  - itemName
  - newPrice
  - oldPrice
  - environment

variables:
  system: EPX
sql:
  check:
    sql: 'select * from items where item_id=:itemId '
    correctWhen: 'should be equal to :newPrice and itemName should be equal to :itemName'
  resolve:
    sql: 'update item set price=:newPrice where itemId=:itemId and price=:old_price'
  validate:
    sql:  'select * from items where item_id = :itemId '
    correctWhen: 'should be equal to :newPrice'















buttons:
  ValidateTicketCreator:
    message: "Please check the ticket creator is in LDAP and a member of the group 'EPX-Project'"
  ValidateApprover:
    message: "Please check the approver is in LDAP and a member of the group 'EPX-Project-Admin'"
  CheckTicket:
    message: "[CheckSql]"
  RequestApproval:
    text: "Request Approval"
    message: "[Email approval]"
    notWhen: approved
  ResolveTicket:
    message: "[ResolveSql]"
    when: approved
  ValidateTicket:
    message: "[ValidateSql]"
